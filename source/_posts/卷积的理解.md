title: 卷积的理解
date: 2015-11-17 21:32:28
tags:
- 卷积
- 图像处理
categories: 
- 理论
mathjax: true 
---
最近计算机视觉课上讲到了卷积，之前没有很好理解，趁此做一个总结。

##定义：

定义一种卷积运算，将两个函数$g(x)$与$f(x)$通过该运算得到$h(x)$
- 卷积有多重解释。泛函中解释为两个函数生成第三个函数的数学算子；概率论解释为两变量叠加的概率密度等，这些解释的特点是两个卷积函数地位是相同的，对应$(f\otimes g) (x) = (g\otimes f) (x)$，具体也有推导，我们不详细研究。
- 这里主要从图像处理和信号方面理解，所以区分原函数与响应函数会比较直观。

##公式：
假设$f(x)$为原函数，$g(x)$为卷积函数，$h(x)$为卷积运算后新生成的函数
- 一维连续： 
$$
h(x) = \int_{-\infty} ^ \infty g(\tau)f(x-\tau)d\tau
$$
- 一维离散：
$$
h(x) = \sum_\tau ^ \infty g(\tau)f(x-\tau)
$$
- 从公式理解：
	- 无限多的离散点就构成了连续，两公式所含意义相同。但往往通过离散公式举例更容易理解。
	- 谈一下$\tau$。卷积可以理解为**对冲击响应的持续叠加**，比如向水中投石头的例子，那这里$-\tau$代表的是时间维度上的残余影响，及过去的单位刺激（负的时间）对现在的的影响，也就是所谓的"翻转"。

##图像：
四幅图对照下文，分别解释了离散和连续情况的卷积运算,后三幅图的三个函数图像分别为原函数$f(x)$，卷积响应函数$g(x)$，和最终卷积运算的结果$h(x)$。
其中图1直接取自百度，图2-4是用matplotlib绘成，使用离散点模拟的连续函数。
<table border="1" align="center"><span style="font-size:24px;color:#006600;"></span>  
<caption align="top">函数图像</caption>  
<tr><td>图一<img src="http://7xjz3b.com1.z0.glb.clouddn.com/juanji1.jpg" width = "300" height = "200" alt="" align=center /></td> <td>图2<img src="http://7xjz3b.com1.z0.glb.clouddn.com/figure_3.png" width = "300" height = "200" alt="" align=center /></td> </tr>
<tr><td>图3<img src="http://7xjz3b.com1.z0.glb.clouddn.com/figure_1.png" width = "300" height = "200" alt="" align=center /></td> <td>图4<img src="http://7xjz3b.com1.z0.glb.clouddn.com/figure_2.png" width = "300" height = "200" alt="" align=center /></td> </tr>
</table>  

##解释：
对卷积的理解很多，比较有直观的有[打拳](http://www.zhihu.com/question/22298352)、[向水中投石](http://www.zhihu.com/question/20500497)这两个例子。这些例子有几个共同的特点：
- 都有一个单位刺激的响应函数。如打一拳引起的疼痛，投一个石头引起的水花；
- 若力度相同（或是石头重量一致），原函数都是$f(x)=1$。把时间推移理解为横轴x；如果拳头的力量或是石头的大小有改变，则原函数$f(x)$变为图4中有波动的原函数。
- 例子中每个时间点观察的结果都是前面所有时间单位响应到目前结果的叠加，与卷积运算得出新函数的意义相同。
- 都是以离散点举例，最后想象无限多个点，进而演变成连续的解释。

结合函数图像来理解，离散的情况如图1，连续情况如图2,3,4。在图2中，g(x)单位高斯函数，在原函数f(x)的上的卷积运算，用引用的帖子中总结概括：**各个时间点上的单位响应的加权叠加**。这里的加权，就是指的原函数f(x)中的函数值。

##我的理解：
- 理解x轴为时间尺度，如果原函数是$f(x)$，响应函数$g(x)$是（0，1）这个点，那么卷积计算结果$h(x) = g(x) \otimes f(x)$的卷积结果是原函数$f(x)$。这是因为响应函数只存在于一点，所以，不会对后面的时间有影响，所以不存在随x轴的叠加————证明了叠加性（图2）
- 如果原函数f(x)是一个常数函数，那么无论单位响应函数形式如何，最后的卷积结果h(x)一定会趋向不变。这是因为原函数值不变，所以权值相同，时间尺度上的叠加都相同，所以函数值稳定后会不变———证明了加权（图3）。

总结一下: **卷积运算可以理解成以原函数$f(x)$为尺度，以响应函数$g(x)$为单位的，随时间尺度的叠加。**


##图像处理的卷积：
在图像中，卷积的使用方式主要是卷积模板的形式。原始的图像可以看做二维数字信号，则可以看做原始图像每个像素与固定长宽的卷积模板做卷积运算。
$$
G(x,y) \otimes I(x,y) = \sum\_{u=-M}^M \sum\_{v=-N}^N G(u,v)I(x-u,y-v)
$$
其中$I(x,y)$代表图像中每一个像素，$G(u,v)$表示尺寸为(2M+1)*(2N+1)的模板
![](http://7xjz3b.com1.z0.glb.clouddn.com/juanji5.jpg)
这些卷积模板是对连续卷积核函数的数字采样近似，相当于上面用离散点近似连续卷积函数。
不同的模板决定了卷积的不同功能：去噪，平滑，匹配等。

##End.

国内的理解与言论貌似只有知乎值得一看，想得到一些更直观的理解时，这里的看法往往独到且深入。而像百度百科、各种博客等大众性解释确误导性严重，看来普及性和质量往往难以共存。




